1. ìœˆë„ìš°ì—ì„œ ë¦¬ëˆ…ìŠ¤ë¡œ ë°ì´í„° ì˜®ê¸°ê¸°
    
    [[Linux] ìœˆë„ìš°ì—ì„œ ë¦¬ëˆ…ìŠ¤ ì„œë²„ì— íŒŒì¼ ì „ì†¡í•˜ê¸°](https://baekh-93.tistory.com/50)
    
    ```bash
    1. PowerShell ì‹¤í–‰.
    
    2. ì „ì†¡í•  íŒŒì¼ ê²½ë¡œë¡œ ì´ë™.
    
    3. ë¦¬ëˆ…ìŠ¤ ì„œë²„ë¡œ íŒŒì¼ ì „ì†¡.(ë¦¬ëˆ…ìŠ¤ ì„œë²„ì˜ ID, IP, PW í•„ìš”)
    ëª…ë ¹ì–´: scp íŒŒì¼ëª… ì„œë²„ê³„ì •ID@ì„œë²„ê³„ì •IP:ë°›ì„ê²½ë¡œ
    ex) scp text.csv hadoop@xxx.xxx.xx.xxx:home/hadoop/data
    # ì„œë²„ê³„ì •ID í™•ì¸
    whoami 
    # ì„œë²„ê³„ì •IP í™•ì¸
    hostname -I 
    ```
    

1. HDFS ì„œë²„ì— ë°ì´í„° ì˜¬ë¦¬ê¸°
    
    ```bash
    1. í•˜ë‘¡ ì‹¤í–‰
    ëª…ë ¹ì–´: start-all.sh
    jps ì‹¤í–‰í•´ì„œ Resource Managerê°€ ì—†ìœ¼ë©´ start-yarn.sh
    
    2. hdfsì— ë””ë ‰í† ë¦¬ ìƒì„±
    ëª…ë ¹ì–´: hdfs dfs -mkdir /user/hive/warehouse/data
    
    3. ë””ë ‰í† ë¦¬ì— íŒŒì¼ ë¶™ì—¬ë„£ê¸°
    ë³µì‚¬í•  íŒŒì¼ì´ ìžˆëŠ” ê²½ë¡œë¡œ ì´ë™ í›„,
    ëª…ë ¹ì–´: hdfs dfs -put XXX.csv /user/hive/warehouse/data
    ```
    
2. HQL íŒŒì¼ ìž‘ì„±í•˜ê¸°
    - a) csvíŒŒì¼ hive í…Œì´ë¸”ì— ë„£ê¸°
        
        ```sql
        -- xxx í…Œì´ë¸”ì´ ìžˆë‹¤ë©´ ì‚­ì œ
        DROP TABLE IF EXISTS xxx;
        
        CREATE EXTERNAL TABLE IF NOT EXISTS xxx ( # ì™¸ë¶€í…Œì´ë¸”ë¡œ ìƒì„±
        code STRING,
        name STRING,
        number INT,
        rate DOUBLE)
        ROW FORMAT DELIMITED
        FILEDS TERMINATED BY ',' -- ,ë¡œ í•„ë“œ êµ¬ë¶„
        LINES TERMINATED BY '\n'  -- \n ìœ¼ë¡œ ë¼ì¸ì„ êµ¬ë¶„
        STORED AS TEXTFILE
        LOCATION 'hdfs://127.0.0.1:9000/user/hive/warehouse/data' -- í•´ë‹¹ ê²½ë¡œì˜ ë°ì´í„°ë¥¼ í…Œì´ë¸”ì— ë“±ë¡
        tblproperties ("skip.header.line.count"="1"); -- íŒŒì¼ì˜ ì²« ì¤„ì€ ë„£ì§€ ì•ŠëŠ”ë‹¤
        ```
        
    - b) hive í…Œì´ë¸”ë“¤ ì²˜ë¦¬í•˜ì—¬ ìƒˆë¡œìš´ í…Œì´ë¸”ì— ë„£ê¸°
        
        ```bash
        # ìƒˆë¡œìš´ í…Œì´ë¸”ì„ ë„£ì„ hdfs ë””ë ‰í† ë¦¬ ìƒì„±
        ëª…ë ¹ì–´: hdfs dfs -mkdir /user/hive/warehouse/data/join
        ```
        
        ```sql
        -- aaa í…Œì´ë¸”ì´ ìžˆë‹¤ë©´ ì‚­ì œ
        DROP TABLE IF EXISTS aaa;
        
        CREATE EXTERNAL TABLE IF NOT EXISTS aaa ( # ì™¸ë¶€í…Œì´ë¸”ë¡œ ìƒì„±
        code STRING,
        name STRING,
        number INT,
        rate DOUBLE)
        STORED AS ORC
        LOCATION 'hdfs://127.0.0.1:9000/user/hive/warehouse/data/join';
        
        INSERT OVERWRITE TABLE aaa
        SELECT a.code, 
        a.name , 
        b.number, 
        b.rate
        FROM aaa a left join bbb b
        on a.code = b.code;
        ```
        
    - ì°¸ê³ ) í…Œì´ë¸” íƒ€ìž…
        
        ### **MANAGED**
        
        í…Œì´ë¸” ìƒì„±ì‹œ ì˜µì…˜ì„ ë”°ë¡œ ì£¼ì§€ ì•Šìœ¼ë©´ ë§¤ë‹ˆì§€ë“œ í…Œì´ë¸”ì´ ìƒì„±ë©ë‹ˆë‹¤. ì„¸ì…˜ì´ ì¢…ë£Œë˜ì–´ë„ í…Œì´ë¸”ì˜ ë°ì´í„°ì™€ íŒŒì¼ì€ ìœ ì§€ ë©ë‹ˆë‹¤. í…Œì´ë¸”ì„ DROP í•˜ë©´ íŒŒì¼ë„ í•¨ê»˜ ì‚­ì œ ë©ë‹ˆë‹¤.
        
        ### **EXTERNAL**
        
        EXTERNAL ì˜µì…˜ì€ ë§¤ë‹ˆì§€ë“œ í…Œì´ë¸”ê³¼ íŒŒì¼ ì‚­ì œ ì •ì±…ì„ ì œì™¸í•˜ê³  ë™ì¼í•©ë‹ˆë‹¤. ìµìŠ¤í„°ë„ í…Œì´ë¸”ì€ DROPí•˜ë©´ íŒŒì¼ì€ ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤. ì‚¬ìš©ìžì˜ ì‹¤ìˆ˜ë¡œ ì¸í•œ íŒŒì¼ ì‚­ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œ EXTERNAL í…Œì´ë¸”ë¡œ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
        
        ### **TEMPORARY**
        
        TEMPORARY ì˜µì…˜ì€ í˜„ìž¬ ì„¸ì…˜ì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” í…Œì´ë¸”ì„ ìƒì„± í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. í˜„ìž¬ ì„¸ì…˜ì´ ì¢…ë£Œë˜ë©´ ì œê±°ë˜ê¸° ë•Œë¬¸ì— ìž„ì‹œ í…Œì´ë¸” ìƒì„±ì— ì‚¬ìš©í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤.
        
    - ì°¸ê³ ) ì €ìž¥ í¬ë§·(STORED AS)
        
        ðŸ’¡**TEXTFILE**: ì¼ë°˜ì ìœ¼ë¡œ external í…Œì´ë¸” ìƒì„± ì‹œ ì‚¬ìš©. ë°ì´í„°ë¥¼ í…ìŠ¤íŠ¸ íŒŒì¼ í˜•íƒœ(csv)ë¡œ HDFSì— ì €ìž¥í•œ ë’¤ external í…Œì´ë¸”ì„ ìƒì„±. êµ¬ë¶„ìžë¡œ fieldì™€ rowê°€ êµ¬ë³„ë˜ì–´ì•¼ í•˜ë©°, í…Œì´ë¸” ìƒì„± ì‹œ DELIMITED ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ êµ¬ë¶„ìžë¥¼ ëª…ì‹œí•œë‹¤.
        
        **SEQUENCEFILE**: ë°ì´í„°ë¥¼ ì••ì¶•í•˜ì—¬ ì €ìž¥. rowê¸°ë°˜ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì €ìž¥. ì½”ë“œ í…Œì´ë¸”, ë””ë©˜ì „ í…Œì´ë¸” ì²˜ëŸ¼ ë°ì´í„°ì™€ ì»¬ëŸ¼ì´ ì ì€ í…Œì´ë¸”ì— ì ìš©í•œë‹¤.
        
        **RCFILE**: ì»¬ëŸ¼ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì••ì¶•í•˜ì—¬ ì €ìž¥í•˜ëŠ” íŒŒì¼ í˜•ì‹. 
        
        ðŸ’¡**ORC**: RCFileì„ ê°œì„ ì‹œí‚¨ íŒŒì¼ í˜•ì‹. ì»¬ëŸ¼ ê¸°ë°˜ ì €ìž¥ ë°©ì‹ì„ ì‚¬ìš©. í˜„ìž¬ íŒŒì¼ í˜•ì‹ì¤‘ì—ì„œ ê°€ìž¥ ë§Žì´ ì‚¬ìš©ë˜ëŠ” íŒŒì¼ í˜•ì‹.
        
        **PARQUET**: ì»¬ëŸ¼ ê¸°ë°˜ ì €ìž¥ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” íŒŒì¼ í˜•ì‹. HIVEì™€ PIGë§Œ ì§€ì›ë˜ëŠ” ORCì— ë¹„í•´ ë” ë‹¤ì–‘í•œ í•˜ë‘¡ ì—ì½” ì‹œìŠ¤í…œì„ ì§€ì›í•˜ê³  ìžˆë‹¤.
        
        **AVRO**: ë°ì´í„° ì§ë ¬í™” ì‹œìŠ¤í…œ. í•˜ë‘¡ì˜ ì§ë ¬í™” ë°©ì‹ì˜ ë‹¨ì ì¸ ì–¸ì–´ ì´ì‹ì„±ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ í”„ë¡œì íŠ¸.
        
    
3. HQL ì‹¤í–‰í•˜ê¸°
    
    ```bash
    ëª…ë ¹ì–´: hive -f hqlíŒŒì¼ì´ ìžˆëŠ” ë””ë ‰í† ë¦¬/hqlíŒŒì¼ëª….hql
    xe) hive -f /home/hadoop/data/test.hql
    ```
    
4. hive ì ‘ì† ë° í…Œì´ë¸” ì¡°íšŒ, ë°ì´í„° ì¡°íšŒ
    
    ```bash
    hive
    > show tables;
    > select * from aaa limit 10;
    ```